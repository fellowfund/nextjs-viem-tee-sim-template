# FellowFund TEE-based Oracle using Phala Network

This repo was strongly based on the [nextjs-viem-tee-sim-template](https://github.com/Phala-Network/nextjs-viem-tee-sim-template) project.

These are the actions we perform in the TEE:

- Read data from FellowFund smart contracts (fellowship applicants)
- Fetch data from GitHub (commits on an specific repo)
- Fetch data from POAP API (events attended on a particular timeframe)
- Compute the KPI metrics, also checking whether the promised metrics by fellowship applicants were met or not
- Sign a transaction with the TEE's address (derived key)
- Submit the transaction on-chain

Also, we get the remote attestation from the TEE to be verified on-chain (for demo purposes, we just mock the verification, given that it was generated by a TEE simulator).

## Requirements

- [Node](https://nodejs.org/en) >= v18.18
- [yarn](https://yarnpkg.com/)
- Docker or Orbstack

## Quickstart

Use docker-compose to bootstrap both the TEE Attestation Simulator and the FellowFund API backend to evaluate metrics, running within the TEE.

```
docker compose up -d
```

## Development

First, run the TEE Attestation Simulator:

```bash
docker run --rm -p 8090:8090 phalanetwork/tappd-simulator:latest
```

Next, download the dependencies with `yarn`

```shell
yarn
```

Build the docker image
```shell
docker build -t fellowfund-api:latest .
```

After the build is successful, run your docker image to connect to the TEE Attestation Simulator
> NOTE: Your docker image hash will be different than the one listed below.
```shell
docker run --rm -p 3000:3000 fellowfund-api:latest
```

## TEE Simulator Info

The following is the TEE Simulator address:

```
0xB20F6adf676D488b22962f0C84CD011BE6DD63cB
```
